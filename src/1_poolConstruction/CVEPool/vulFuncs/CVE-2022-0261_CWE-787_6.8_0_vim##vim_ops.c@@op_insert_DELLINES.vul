-		off = (*mb_off_next)(oldp, oldp + offset);
-		offset += off;
-	    spaces -= off;
-	    count -= off;
-	newp = alloc(STRLEN(oldp) + s_len + count + 1);
-	mch_memmove(newp, oldp, (size_t)(offset));
-	if (spaces && !bdp->is_short)
-	    // insert post-padding
-	    vim_memset(newp + offset + spaces, ' ', (size_t)(ts_val - spaces));
-	    // We're splitting a TAB, don't copy it.
-	    oldp++;
-	    // We allowed for that TAB, remember this now
-	    count++;
-			&& oap->end.col + oap->end.coladd
