+  // Since crop arguments are user controlled, check for overflow.
+  int64_t crop_area = MultiplyWithoutOverflow(crop_height, crop_width);
+  if (crop_area < 0)
+    return errors::InvalidArgument("Cannot estimate cost, multiplying ",
+                                   crop_height, " with ", crop_width,
+                                   " would overflow");
+  int64_t crop_volume = MultiplyWithoutOverflow(crop_area, num_boxes);
+  if (crop_volume < 0)
+    return errors::InvalidArgument("Cannot estimate cost, multiplying ",
+                                   crop_area, " with ", num_boxes,
+                                   " would overflow");
+  int64_t crop_depth = MultiplyWithoutOverflow(crop_height, num_boxes);
+  if (crop_depth < 0)
+    return errors::InvalidArgument("Cannot estimate cost, multiplying ",
+                                   crop_height, " with ", num_boxes,
+                                   " would overflow");
+
+  ops += (mul_cost * 2 + sub_cost + add_cost) * crop_depth;
+  ops += (mul_cost * 2 + sub_cost + add_cost) * crop_volume;
+    ops += (floor_cost + ceil_cost + sub_cost) * crop_depth;
+    ops += (floor_cost + ceil_cost + sub_cost) * crop_volume;
+    ops += round_cost * 2 * crop_volume;
